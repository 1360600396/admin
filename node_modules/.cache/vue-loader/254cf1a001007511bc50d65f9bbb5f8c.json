{"remainingRequest":"C:\\Users\\zxb\\Desktop\\黑马前端\\课件源码资料\\阶段五 Vue2+Vue3项目实战开发\\黑马智数项目-配套资料\\黑马智数项目-配套资料\\项目代码\\hmzs\\hmzs-admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\zxb\\Desktop\\黑马前端\\课件源码资料\\阶段五 Vue2+Vue3项目实战开发\\黑马智数项目-配套资料\\黑马智数项目-配套资料\\项目代码\\hmzs\\hmzs-admin\\src\\views\\Park\\Enterprise\\AddEnterprise.vue?vue&type=style&index=0&id=2f2aa2ef&scoped=true&lang=scss&","dependencies":[{"path":"C:\\Users\\zxb\\Desktop\\黑马前端\\课件源码资料\\阶段五 Vue2+Vue3项目实战开发\\黑马智数项目-配套资料\\黑马智数项目-配套资料\\项目代码\\hmzs\\hmzs-admin\\src\\views\\Park\\Enterprise\\AddEnterprise.vue","mtime":1704167261088},{"path":"C:\\Users\\zxb\\Desktop\\黑马前端\\课件源码资料\\阶段五 Vue2+Vue3项目实战开发\\黑马智数项目-配套资料\\黑马智数项目-配套资料\\项目代码\\hmzs\\hmzs-admin\\node_modules\\css-loader\\dist\\cjs.js","mtime":1714140750111},{"path":"C:\\Users\\zxb\\Desktop\\黑马前端\\课件源码资料\\阶段五 Vue2+Vue3项目实战开发\\黑马智数项目-配套资料\\黑马智数项目-配套资料\\项目代码\\hmzs\\hmzs-admin\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1714140755034},{"path":"C:\\Users\\zxb\\Desktop\\黑马前端\\课件源码资料\\阶段五 Vue2+Vue3项目实战开发\\黑马智数项目-配套资料\\黑马智数项目-配套资料\\项目代码\\hmzs\\hmzs-admin\\node_modules\\postcss-loader\\src\\index.js","mtime":1714140753336},{"path":"C:\\Users\\zxb\\Desktop\\黑马前端\\课件源码资料\\阶段五 Vue2+Vue3项目实战开发\\黑马智数项目-配套资料\\黑马智数项目-配套资料\\项目代码\\hmzs\\hmzs-admin\\node_modules\\sass-loader\\dist\\cjs.js","mtime":1714140750590},{"path":"C:\\Users\\zxb\\Desktop\\黑马前端\\课件源码资料\\阶段五 Vue2+Vue3项目实战开发\\黑马智数项目-配套资料\\黑马智数项目-配套资料\\项目代码\\hmzs\\hmzs-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1714140753088},{"path":"C:\\Users\\zxb\\Desktop\\黑马前端\\课件源码资料\\阶段五 Vue2+Vue3项目实战开发\\黑马智数项目-配套资料\\黑马智数项目-配套资料\\项目代码\\hmzs\\hmzs-admin\\node_modules\\vue-loader\\lib\\index.js","mtime":1714140753454}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCi5hZGQtZW50ZXJwcmlzZSB7CiAgYmFja2dyb3VuZC1jb2xvcjogI2Y0ZjZmODsKICBoZWlnaHQ6IDEwMHZoOwoKICAuYWRkLWhlYWRlciB7CiAgICBkaXNwbGF5OiBmbGV4OwogICAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuOwogICAgcGFkZGluZzogMCAyMHB4OwogICAgaGVpZ2h0OiA2NHB4OwogICAgbGluZS1oZWlnaHQ6IDY0cHg7CiAgICBmb250LXNpemU6IDE2cHg7CiAgICBmb250LXdlaWdodDogYm9sZDsKICAgIGJhY2tncm91bmQtY29sb3I6ICNmZmY7CgogICAgLmxlZnQgewogICAgICBzcGFuIHsKICAgICAgICBtYXJnaW4tcmlnaHQ6IDRweDsKICAgICAgfQogICAgICAuYXJyb3d7CiAgICAgICAgY3Vyc29yOiBwb2ludGVyOwogICAgICB9CiAgICB9CgogICAgLnJpZ2h0IHsKICAgICAgdGV4dC1hbGlnbjogcmlnaHQ7CiAgICB9CiAgfQoKICAuYWRkLW1haW4gewogICAgYmFja2dyb3VuZDogI2Y0ZjZmODsKICAgIHBhZGRpbmc6IDIwcHggMTMwcHg7CgogICAgLmZvcm0tY29udGFpbmVyIHsKICAgICAgYmFja2dyb3VuZC1jb2xvcjogI2ZmZjsKICAgICAgLnRpdGxlIHsKICAgICAgICBoZWlnaHQ6IDYwcHg7CiAgICAgICAgbGluZS1oZWlnaHQ6IDYwcHg7CiAgICAgICAgcGFkZGluZy1sZWZ0OjIwcHg7CiAgICAgIH0KICAgICAgLmZvcm0gewogICAgICAgIG1hcmdpbi1ib3R0b206IDIwcHg7CiAgICAgICAgcGFkZGluZzogMjBweCA2NXB4IDI0cHg7CiAgICAgICAgLmVsLWZvcm17CiAgICAgICAgICBkaXNwbGF5OiBmbGV4OwogICAgICAgICAgZmxleC13cmFwOiB3cmFwOwogICAgICAgICAgLmVsLWZvcm0taXRlbXsKICAgICAgICAgICAgd2lkdGg6IDUwJTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9CgogIC5hZGQtZm9vdGVyIHsKICAgIHBvc2l0aW9uOiBmaXhlZDsKICAgIGJvdHRvbTogMDsKICAgIHdpZHRoOiAxMDAlOwogICAgcGFkZGluZzogMjRweCA1MHB4OwogICAgY29sb3I6ICMwMDAwMDBkOTsKICAgIGZvbnQtc2l6ZTogMTRweDsKICAgIGJhY2tncm91bmQ6ICNmZmY7CiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7CiAgfQogIC5pbWd7CiAgICB3aWR0aDogMTUwcHg7CiAgICBoZWlnaHQ6IDE1MHB4OwogICAgYm9yZGVyLXJhZGl1czogNHB4OwogIH0KfQo="},{"version":3,"sources":["AddEnterprise.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqOA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"AddEnterprise.vue","sourceRoot":"src/views/Park/Enterprise","sourcesContent":["<template>\n  <div class=\"add-enterprise\">\n    <header class=\"add-header\">\n      <div class=\"left\">\n        <span class=\"arrow\" @click=\"$router.back()\"><i class=\"el-icon-arrow-left\" />返回</span>\n        <span>|</span>\n        <span>{{ id?'编辑企业':'添加企业' }}</span>\n      </div>\n      <div class=\"right\">\n        黑马程序员\n      </div>\n    </header>\n    <main class=\"add-main\">\n      <div class=\"form-container\">\n        <div class=\"title\">企业信息</div>\n        <div class=\"form\">\n          <el-form ref=\"ruleForm\" :model=\"addForm\" :rules=\"addRules\" label-width=\"100px\">\n            <el-form-item label=\"企业名称\" prop=\"name\">\n              <el-input v-model=\"addForm.name\" />\n            </el-form-item>\n            <el-form-item label=\"法人\" prop=\"legalPerson\">\n              <el-input v-model=\"addForm.legalPerson\" />\n            </el-form-item>\n            <el-form-item label=\"注册地址\" prop=\"registeredAddress\">\n              <el-input v-model=\"addForm.registeredAddress\" />\n            </el-form-item>\n            <el-form-item label=\"所在行业\" prop=\"industryCode\">\n              <el-select v-model=\"addForm.industryCode\" @focus=\"selectFocus\">\n                <el-option\n                  v-for=\"item in industryList\"\n                  :key=\"item.industryCode\"\n                  :value=\"item.industryCode\"\n                  :label=\"item.industryName\"\n                />\n              </el-select>\n            </el-form-item>\n            <el-form-item label=\"企业联系人\" prop=\"contact\">\n              <el-input v-model=\"addForm.contact\" />\n            </el-form-item>\n            <el-form-item label=\"联系电话\" prop=\"contactNumber\">\n              <el-input v-model=\"addForm.contactNumber\" />\n            </el-form-item>\n            <el-form-item label=\"营业执照\" prop=\"businessLicenseId\">\n              <!--\n                action本来是一个用来配置默认上传的接口地址的\n                因为我们覆盖了 所以用一个#占个位置 消除必填警告\n\n                input type=\"file\" 本身具备选择文件的能力\n                覆盖原因: 默认的配置上传不够灵活 仅支持一些简单的上传 如果想要完全自定义上传行为 http-request\n\n                在选择文件之后 自动执行upload函数 并且把一个对象给到我们 对象中有一个file属性 就是我们要上传的文件对象\n\n                上传前校验\n                 1. 上传图片之前加一层校验 目的为了限制用户上传的文件类型和大小\n                 2. 如果我们添加了before-upload这个属性方法 这个函数中必须return的数据为true\n                 才会继续执行 upload 方法 如果校验不过 暂停执行 不会走上传逻辑\n                 3. file对象中俩个属性\n                    size  文件大小 /1024/1024 = M\n                    type  文件类型 image/文件类型\n               -->\n              <el-upload\n                class=\"upload-demo\"\n                action=\"#\"\n                :http-request=\"upload\"\n                :before-upload=\"beforeUpload\"\n              >\n                <el-button size=\"small\" type=\"primary\">点击上传</el-button>\n                <div slot=\"tip\" class=\"el-upload__tip\">只能上传png图片，且不超过5M</div>\n              </el-upload>\n              <img :src=\"addForm.businessLicenseUrl\" alt=\"\" class=\"img\">\n            </el-form-item>\n          </el-form>\n        </div>\n      </div>\n    </main>\n    <footer class=\"add-footer\">\n      <div class=\"btn-container\">\n        <el-button>重置</el-button>\n        <el-button type=\"primary\" @click=\"confirmAdd\">确定</el-button>\n      </div>\n    </footer>\n  </div>\n</template>\n\n<script>\nimport { updateEnterpriseAPI, getIndustryListAPI, createEnterpriseAPI, getEnterpriseDetailAPI } from '@/api/park'\nimport { uploadAPI } from '@/api/common'\nexport default {\n  data() {\n    const validatePhone = (rule, value, cb) => {\n      if (/^1[3-9]\\d{9}$/.test(value)) {\n        cb()\n      } else {\n        cb(new Error('请输入正确手机号'))\n      }\n    }\n    return {\n      addForm: {\n        name: '', // 企业名称\n        legalPerson: '', // 法人\n        registeredAddress: '', // 注册地址\n        industryCode: '', // 所在行业\n        contact: '', // 企业联系人\n        contactNumber: '', // 联系人电话\n        businessLicenseUrl: '', // 营业执照url\n        businessLicenseId: '' // 营业执照id\n      },\n      addRules: {\n        name: [\n          { required: true, message: '企业名称为必填', trigger: 'blur' }\n        ],\n        legalPerson: [\n          { required: true, message: '法人为必填', trigger: 'blur' }\n        ],\n        registeredAddress: [\n          { required: true, message: '注册地址为必填', trigger: 'blur' }\n        ],\n        industryCode: [\n          { required: true, message: '所在行业为必填', trigger: 'blur' }\n        ],\n        contact: [\n          { required: true, message: '企业联系人为必填', trigger: 'blur' }\n        ],\n        contactNumber: [\n          { required: true, message: '企业联系人电话为必填', trigger: 'blur' },\n          { validator: validatePhone, trigger: 'blur' }\n        ],\n        businessLicenseId: [\n          { required: true, message: '请上传营业执照', trigger: 'blur' }\n        ]\n      },\n      industryList: [] // 行业列表\n    }\n  },\n  computed: {\n    id() {\n      return this.$route.query.id\n    }\n  },\n  mounted() {\n    // 模版的渲染会等待这个接口返回吗？\n    // 不是\n    // 首先会以data中默认的数据完成第一次渲染\n    // 等到接口数据返回之后 由于响应式数据的变化 视图会跟着一起变 完成二次渲染\n    this.getIndustryList()\n    if (this.id) {\n      this.getDetail()\n    }\n  },\n  methods: {\n    async getDetail() {\n      const res = await getEnterpriseDetailAPI(this.id)\n      this.addForm = res.data\n    },\n    // 聚焦时出发\n    selectFocus() {\n      this.getIndustryList()\n    },\n    // 获取行业列表\n    async getIndustryList() {\n      const res = await getIndustryListAPI()\n      this.industryList = res.data\n    },\n    async upload(res) {\n      console.log(res)\n      // file：要上传给后端接口的文件对象\n      const { file } = res\n      // 上传文件\n      // 1. 按照接口要求准备一个符合类型的formData对象 然后把参数加入进去\n      const fd = new FormData() // formData实例对象 内部是空的\n      fd.append('file', file)\n      fd.append('type', 'businessLicense')\n      // 2. 调用接口\n      const _res = await uploadAPI(fd)\n      this.addForm.businessLicenseId = _res.data.id\n      this.addForm.businessLicenseUrl = _res.data.url\n      // 上传之后对营业执照id做校验(保证先上传完毕 赋值成功之后 再做校验)\n      /**\n       1. 为什么要单独对这个上传做校验？\n          上传组件在上传完毕之后 已经有图片了 但是错误提示没有消失掉\n          el-form组件校验逻辑里面  el-input el-select 当有值之后会自动完成校验\n\n       2. 怎么做？\n          validateField  表单组件的实例方法 参数要单独校验哪个字段 就把它传入\n          通过我们传入的字段 去自动查找当前字段是否符合规则要求 如果符合 清空错误提示\n       */\n      this.$refs.ruleForm.validateField('businessLicenseId')\n    },\n    beforeUpload(file) {\n      console.log(file)\n      const isPNG = file.type === 'image/png'\n      const isLt5M = file.size / 1024 / 1024 < 5\n\n      if (!isPNG) {\n        this.$message.error('上传合同文件只能是 PNG 格式!')\n      }\n      if (!isLt5M) {\n        this.$message.error('上传合同文件大小不能超过5MB!')\n      }\n      return isPNG && isLt5M\n    },\n    confirmAdd() {\n      this.$refs.ruleForm.validate(async valid => {\n        if (valid) {\n          // TODO\n          if (this.id) {\n            // 更新接口\n            const {\n              name, id, legalPerson, registeredAddress, industryCode, businessLicenseId,\n              businessLicenseUrl, contact, contactNumber\n            } = this.addForm\n            await updateEnterpriseAPI({\n              name, id, legalPerson, registeredAddress, industryCode, businessLicenseId,\n              businessLicenseUrl, contact, contactNumber\n            })\n          } else {\n            await createEnterpriseAPI(this.addForm)\n          }\n\n          this.$message.success(`${this.id ? '更新成功' : '新增成功'}`)\n          this.$router.back()\n        }\n      })\n    }\n  }\n}\n</script>\n\n<style scoped lang=\"scss\">\n.add-enterprise {\n  background-color: #f4f6f8;\n  height: 100vh;\n\n  .add-header {\n    display: flex;\n    justify-content: space-between;\n    padding: 0 20px;\n    height: 64px;\n    line-height: 64px;\n    font-size: 16px;\n    font-weight: bold;\n    background-color: #fff;\n\n    .left {\n      span {\n        margin-right: 4px;\n      }\n      .arrow{\n        cursor: pointer;\n      }\n    }\n\n    .right {\n      text-align: right;\n    }\n  }\n\n  .add-main {\n    background: #f4f6f8;\n    padding: 20px 130px;\n\n    .form-container {\n      background-color: #fff;\n      .title {\n        height: 60px;\n        line-height: 60px;\n        padding-left:20px;\n      }\n      .form {\n        margin-bottom: 20px;\n        padding: 20px 65px 24px;\n        .el-form{\n          display: flex;\n          flex-wrap: wrap;\n          .el-form-item{\n            width: 50%;\n          }\n        }\n      }\n    }\n  }\n\n  .add-footer {\n    position: fixed;\n    bottom: 0;\n    width: 100%;\n    padding: 24px 50px;\n    color: #000000d9;\n    font-size: 14px;\n    background: #fff;\n    text-align: center;\n  }\n  .img{\n    width: 150px;\n    height: 150px;\n    border-radius: 4px;\n  }\n}\n</style>\n"]}]}